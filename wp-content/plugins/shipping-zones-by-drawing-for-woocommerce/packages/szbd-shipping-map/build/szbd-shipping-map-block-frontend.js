!function(){"use strict";var e={n:function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,{a:n}),n},d:function(t,n){for(var s in n)e.o(n,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:n[s]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},t=window.wc.blocksCheckout,n=window.React,s=window.wc.wcBlocksData,a=window.wp.element,i=window.wp.i18n,d=window.wp.data,o=window.lodash,r=e.n(o);"undefined"!=typeof window?n.useLayoutEffect:n.useEffect;var c=function(e,t){const s=function(){const e=(0,n.useRef)(!0);return e.current?(e.current=!1,!0):e.current}();(0,n.useEffect)((()=>{if(!s)return e()}),t)},l=window.wc.wcSettings,p=JSON.parse('{"apiVersion":2,"name":"szbd-shipping-message/szbd-shipping-map-block","version":"2.0.0","title":"Map and Plus Code Form","category":"woocommerce","description":"Adds a shipping map and a plus code form (Shipping Zones by Drawing)","supports":{"html":false,"align":false,"multiple":false,"reusable":false},"parent":["woocommerce/checkout-shipping-address-block"],"attributes":{"lock":{"type":"object","default":{"remove":true,"move":true}},"text":{"type":"string","default":""}},"textdomain":"szbd","editorStyle":"file:../../../build/style-szbd-shipping-map-block.css","style":"file:../../../build/style-index.css"}');(0,t.registerCheckoutBlock)({metadata:p,component:({checkoutExtensionData:e,extensions:p})=>{const{szbd_precise_address_mandatory:u,szbd_precise_address:m,szbd_precise_address_plus_code:f}=(0,l.getSetting)("szbd-shipping-map_data",""),{__internalIncrementCalculating:b,__internalDecrementCalculating:g}=(0,d.useDispatch)("wc/store/checkout"),{setExtensionData:_}=((0,a.useCallback)((0,o.debounce)(((e,n)=>{(0,t.extensionCartUpdate)(e,n)}),1e3),[t.extensionCartUpdate]),e),[h,w]=(0,a.useState)({}),[E,v]=(0,a.useState)(""),[z,k]=(0,a.useState)(""),y="szbd-no-picked-location",{setValidationErrors:S,clearValidationError:C,showValidationError:x}=(0,d.useDispatch)("wc/store/validation"),{setIsCartDataStale:N,selectShippingRate:R,updatingCustomerData:O,applyExtensionCartUpdate:D,shippingRatesBeingSelected:U}=(0,d.useDispatch)(s.CART_STORE_KEY),T=(0,d.useSelect)((e=>e("wc/store/validation").getValidationError(y))),P=(0,d.useSelect)((e=>e(s.CART_STORE_KEY)));(0,d.useSelect)((e=>e(s.CHECKOUT_STORE_KEY)));const L=(0,d.useSelect)((e=>e(s.CART_STORE_KEY).getCartData())),j=function(){const e=(0,n.useRef)(!1);return(0,n.useEffect)((()=>(e.current=!0,()=>{e.current=!1})),[]),(0,n.useCallback)((()=>e.current),[])}();function A(){if(_("szbd","point",h),"no"==m||"no"==u)return void(T&&C(y));if(0!=Object.keys(h).length)return void(T&&C(y));const e=r().isUndefined(L.shippingRates[0])?void 0:r().find(L.shippingRates[0].shipping_rates,{method_id:"local_pickup",selected:!0});!r().isUndefined(e)||function(){if("always"==m)return!1;const e=document.getElementById("szbd_checkout_field");return"none"===window.getComputedStyle(e).display}()?T&&C(y):T||S({[y]:{message:(0,i.__)("Please pick a shipping location on the map.","szbd"),hidden:!0}})}function I(e){return""!=e.shippingAddress.address_1}var K;c((()=>{A()}),[h,L]),(0,a.useEffect)((()=>{_("szbd","pluscode",E)}),[_,E]),(0,a.useEffect)((()=>{const e=()=>{if(j()){let e=I(L);jQuery(document).trigger("szbd_map_loaded_blocks",[L,e])}A()};return window.addEventListener("load",e),window.addEventListener("szbd_map_loaded",e),(()=>{const e=r().isUndefined(L)||r().isNull(L)||r().isUndefined(L.extensions)||r().isUndefined(L.extensions["szbd-shipping-map"])?null:L.extensions["szbd-shipping-map"].shipping_point;if(!r().isNull(e)&&r().has(e,"fromUI"))return;let t=I(L);jQuery(document).trigger("szbd_map_update_blocks",[L,t])})(),()=>{window.removeEventListener("load",e),window.removeEventListener("szbd_map_loaded",e)}}),[L,j]),K=()=>{if(P.getNeedsShipping()){const e=new Event("szbd_map_loaded");window.dispatchEvent(e)}},(0,n.useEffect)(K,[]);{const e="yes"==u?(0,i.__)("Please Precise Your Shipping Location","szbd"):(0,i.__)("Precise Address?","szbd");return(0,n.createElement)("div",{className:"szbd-shipping-details-block"},(0,n.createElement)("div",null,(0,n.createElement)("input",{id:"szbd-picked",onChange:e=>{(e=>{var t;"empty"!=e.target.value?function(e){try{JSON.parse(e)}catch(e){return!1}return!0}(e.target.value)&&(t=JSON.parse(e.target.value),w(t),e.nativeEvent.data.notToServer||D({namespace:"szbd-shipping-map-update",data:{lat:t.lat,lng:t.lng}}).then((function(e){}))):w({})})(e)},value:h,type:"text",className:"szbd-hidden"+(!1===T?.hidden?" has-error":"")})),(0,n.createElement)("div",{id:"szbd_checkout_field",className:"at_fail"==m?" at_fail":""},"yes"==f?(0,n.createElement)("div",{className:"szbd-pluscode"},(0,n.createElement)(t.TextInput,{id:"szbd-plus-code",type:"text",required:!1,className:"szbd-plus-code-form",label:(0,i.__)("Find Location with Google Plus Code","szbd"),value:E,onChange:e=>{(e=>{if("updateserver"==e)v(""),(0,t.extensionCartUpdate)({namespace:"szbd-shipping-map-update",data:{lat:null,lng:null}});else{if("empty"==e)return void v("");v(e)}})(e)}})):"",T?.hidden?null:(0,n.createElement)("div",{className:"wc-block-components-validation-error",role:"alert"},(0,n.createElement)("p",null,T?.message)),(0,n.createElement)("div",{className:"wc-block-components-title szbd-map-title-block"},e),(0,n.createElement)("div",{id:"szbd-pick-content"},(0,n.createElement)("div",{className:"szbd-checkout-map"},(0,n.createElement)("div",{id:"szbd_map"})))))}}})}();